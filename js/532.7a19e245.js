"use strict";(self["webpackChunkschool_lessons"]=self["webpackChunkschool_lessons"]||[]).push([[532],{7532:function(e,t,s){s.r(t),s.d(t,{default:function(){return ie}});var a=s(6768);function i(e,t,s,i,r,n){const o=(0,a.g2)("ShoppingCart");return(0,a.uX)(),(0,a.Wv)(o)}var r=s(4232),n=s(5130);const o={class:"container py-4"},l={class:"d-flex justify-content-between align-items-center mb-4"},c={key:0,class:"text-center py-5"},d={key:1,class:"alert alert-danger",role:"alert"},m={key:2,class:"text-center py-5"},u={key:3,class:"row"},h={class:"col-lg-8"},b={class:"card border-0 shadow-sm mb-4"},k={class:"card-body"},p={class:"cart-items"},v={class:"col-lg-4"},y={class:"card border-0 shadow-sm"},L={class:"card-body"},C={class:"price-summary mb-4"},f={class:"d-flex justify-content-between mb-3"},g={class:"fw-bold"},F={class:"mb-3"},w={class:"invalid-feedback"},I={class:"mb-3"},_={class:"invalid-feedback"},q={class:"d-grid gap-2"},x=["disabled"];function E(e,t,s,i,E,X){const P=(0,a.g2)("router-link"),Q=(0,a.g2)("cartItem");return(0,a.uX)(),(0,a.CE)("div",o,[(0,a.Lk)("div",l,[t[6]||(t[6]=(0,a.Lk)("h2",{class:"fw-bold mb-0"},"Shopping Cart",-1)),e.hasItems?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:t[0]||(t[0]=(...t)=>e.clearCart&&e.clearCart(...t)),class:"btn btn-outline-danger btn-sm"},t[5]||(t[5]=[(0,a.Lk)("i",{class:"bi bi-trash me-2"},null,-1),(0,a.eW)("Clear Cart ")]))):(0,a.Q3)("",!0)]),E.loading?((0,a.uX)(),(0,a.CE)("div",c,t[7]||(t[7]=[(0,a.Lk)("div",{class:"spinner-border text-primary",role:"status"},[(0,a.Lk)("span",{class:"visually-hidden"},"Loading...")],-1)]))):e.error?((0,a.uX)(),(0,a.CE)("div",d,(0,r.v_)(e.error),1)):e.hasItems?((0,a.uX)(),(0,a.CE)("div",u,[(0,a.Lk)("div",h,[(0,a.Lk)("div",b,[(0,a.Lk)("div",k,[(0,a.Lk)("div",p,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.sortedCartItems,(t=>((0,a.uX)(),(0,a.CE)("div",{key:t.id,class:"cart-item p-3 mb-3 bg-light rounded"},[(0,a.bF)(Q,{item:t,onRemove:X.handleRemoveItem,onUpdateQuantity:e.handleUpdateQuantity},null,8,["item","onRemove","onUpdateQuantity"])])))),128))])])])]),(0,a.Lk)("div",v,[(0,a.Lk)("div",y,[(0,a.Lk)("div",L,[t[16]||(t[16]=(0,a.Lk)("h5",{class:"card-title mb-4"},"Order Summary",-1)),(0,a.Lk)("div",C,[(0,a.Lk)("div",f,[t[12]||(t[12]=(0,a.Lk)("span",{class:"fw-bold"},"Total",-1)),(0,a.Lk)("span",g,"£"+(0,r.v_)(e.cartTotal),1)])]),(0,a.Lk)("form",{onSubmit:t[4]||(t[4]=(0,n.D$)(((...e)=>X.handleCheckout&&X.handleCheckout(...e)),["prevent"]))},[(0,a.Lk)("div",F,[t[13]||(t[13]=(0,a.Lk)("label",{class:"form-label"},"Name",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>E.checkoutForm.name=e),class:(0,r.C4)(["form-control",{"is-invalid":E.errors.name}]),required:""},null,2),[[n.Jo,E.checkoutForm.name]]),(0,a.Lk)("div",w,(0,r.v_)(E.errors.name),1)]),(0,a.Lk)("div",I,[t[14]||(t[14]=(0,a.Lk)("label",{class:"form-label"},"Phone",-1)),(0,a.bo)((0,a.Lk)("input",{type:"tel","onUpdate:modelValue":t[2]||(t[2]=e=>E.checkoutForm.phone=e),onInput:t[3]||(t[3]=(...e)=>X.validatePhone&&X.validatePhone(...e)),class:(0,r.C4)(["form-control",{"is-invalid":E.errors.phone}]),required:""},null,34),[[n.Jo,E.checkoutForm.phone]]),(0,a.Lk)("div",_,(0,r.v_)(E.errors.phone),1)]),(0,a.Lk)("div",q,[(0,a.Lk)("button",{type:"submit",class:"btn btn-primary",disabled:E.loading||!X.isFormValid},[t[15]||(t[15]=(0,a.Lk)("i",{class:"bi bi-credit-card me-2"},null,-1)),(0,a.eW)(" Checkout ("+(0,r.v_)(e.cartItemCount)+" items) ",1)],8,x)])],32)])])])])):((0,a.uX)(),(0,a.CE)("div",m,[t[9]||(t[9]=(0,a.Lk)("i",{class:"bi bi-cart-x display-1 text-muted"},null,-1)),t[10]||(t[10]=(0,a.Lk)("h3",{class:"mt-3"},"Your cart is empty",-1)),t[11]||(t[11]=(0,a.Lk)("p",{class:"text-muted mb-4"},"Add some lessons to get started",-1)),(0,a.bF)(P,{to:"/lessons",class:"btn btn-primary"},{default:(0,a.k6)((()=>t[8]||(t[8]=[(0,a.Lk)("i",{class:"bi bi-book me-2"},null,-1),(0,a.eW)("Browse Lessons ")]))),_:1})]))])}var X=s(782);const P={class:"cart-item-container"},Q={class:"d-flex justify-content-between align-items-center flex-wrap"},j={class:"d-flex align-items-center subject-info"},S={class:"subject-icon me-3"},W={class:"mb-1"},$={class:"text-muted small mb-1"},R={class:"text-muted small"},U={class:"controls-section"},V={class:"quantity-wrapper me-4"},A={class:"quantity-control d-flex align-items-center"},O=["disabled"],D={class:"quantity-display mx-3"},N=["disabled"],T={class:"price-remove-section text-end"},J={class:"price-section mb-2"},B={class:"fw-bold"},H={key:0,class:"text-muted"};function K(e,t,s,i,n,o){return(0,a.uX)(),(0,a.CE)("div",P,[(0,a.Lk)("div",Q,[(0,a.Lk)("div",j,[(0,a.Lk)("div",S,[(0,a.Lk)("i",{class:(0,r.C4)([s.item?.icon,"fs-3"])},null,2)]),(0,a.Lk)("div",null,[(0,a.Lk)("h5",W,(0,r.v_)(s.item.subject),1),(0,a.Lk)("div",$,[t[3]||(t[3]=(0,a.Lk)("i",{class:"bi bi-geo-alt me-1"},null,-1)),(0,a.eW)(" "+(0,r.v_)(s.item.location),1)]),(0,a.Lk)("div",R,[t[4]||(t[4]=(0,a.Lk)("i",{class:"bi bi-person me-1"},null,-1)),(0,a.eW)(" "+(0,r.v_)(o.availableSpaces)+" remaining ",1)])])]),(0,a.Lk)("div",U,[(0,a.Lk)("div",V,[t[7]||(t[7]=(0,a.Lk)("label",{class:"form-label small text-muted mb-2"},"Quantity:",-1)),(0,a.Lk)("div",A,[(0,a.Lk)("button",{onClick:t[0]||(t[0]=e=>o.updateQuantity(s.item.quantity-1)),class:"btn btn-outline-secondary btn-sm",disabled:s.item.quantity<=1,title:"Decrease quantity"},t[5]||(t[5]=[(0,a.Lk)("i",{class:"bi bi-dash"},null,-1)]),8,O),(0,a.Lk)("span",D,(0,r.v_)(s.item.quantity),1),(0,a.Lk)("button",{onClick:t[1]||(t[1]=e=>o.updateQuantity(s.item.quantity+1)),class:"btn btn-outline-secondary btn-sm",disabled:s.item.quantity>=s.item.spaces,title:"Increase quantity"},t[6]||(t[6]=[(0,a.Lk)("i",{class:"bi bi-plus"},null,-1)]),8,N)])]),(0,a.Lk)("div",T,[(0,a.Lk)("div",J,[(0,a.Lk)("div",B,"£"+(0,r.v_)(o.totalPrice),1),s.item.quantity>1?((0,a.uX)(),(0,a.CE)("small",H," £"+(0,r.v_)(s.item.price)+" each ",1)):(0,a.Q3)("",!0)]),(0,a.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>o.removeItem&&o.removeItem(...e)),class:"btn btn-outline-danger btn-sm",title:"Remove from cart"},t[8]||(t[8]=[(0,a.Lk)("i",{class:"bi bi-trash me-1"},null,-1),(0,a.eW)(" Remove ")]))])])])])}var Y={name:"CartItem",props:{item:{type:Object,required:!0,validator:e=>["_id","subject","location","price","spaces","quantity","icon"].every((t=>t in e))}},computed:{totalPrice(){return this.item.price*(this.item.quantity||1)},availableSpaces(){return`${this.item.spaces} space${1!==this.item.spaces?"s":""}`}},methods:{updateQuantity(e){e>=1&&e<=this.item.spaces&&this.$store.dispatch("cart/updateQuantity",{lessonId:this.item._id,quantity:e})},removeItem(){this.$store.dispatch("cart/removeFromCart",this.item._id)}}},z=s(1241);const G=(0,z.A)(Y,[["render",K],["__scopeId","data-v-31e2c340"]]);var M=G,Z={name:"CartView",components:{cartItem:M},data(){return{checkoutForm:{name:"",phone:""},errors:{name:"",phone:""},loading:!1}},computed:{...(0,X.aH)("cart",["error"]),...(0,X.L8)("cart",["sortedCartItems","hasItems","cartItemCount","cartTotal"]),isFormValid(){return this.checkoutForm.name&&this.checkoutForm.phone&&!this.errors.name&&!this.errors.phone}},methods:{...(0,X.i0)("cart",["removeFromCart","clearCart"]),digitsOnly(e){return e.replace(/\D/g,"")},validatePhone(){const e=/^[\d\s\-+()]{8,20}$/,t=this.checkoutForm.phone.trim(),s=this.digitsOnly(t);t?e.test(t)?s.length<8||s.length>15?this.errors.phone="Phone number must be between 8 and 15 digits":this.errors.phone="":this.errors.phone="Please enter a valid phone number":this.errors.phone="Phone number is required"},validateForm(){let e=!0;return this.errors={name:"",phone:""},this.checkoutForm.name.trim()?this.checkoutForm.name.length<2&&(this.errors.name="Name must be at least 2 characters",e=!1):(this.errors.name="Name is required",e=!1),this.validatePhone(),this.errors.phone&&(e=!1),e},async handleRemoveItem(e){try{await this.removeFromCart(e.id)}catch(t){console.error("Failed to remove item:",t)}},async handleCheckout(){if(this.validateForm()){this.loading=!0;try{const e={name:this.checkoutForm.name,phone:this.checkoutForm.phone},t=await this.$store.dispatch("cart/checkout",e);if(!t.success)throw new Error(t.error||"Checkout failed");this.checkoutForm={name:"",phone:""}}catch(e){console.error("Checkout failed:",e),this.errors.submit=e.message}finally{this.loading=!1}}}}};const ee=(0,z.A)(Z,[["render",E],["__scopeId","data-v-2edd4cd7"]]);var te=ee,se={components:{ShoppingCart:te}};const ae=(0,z.A)(se,[["render",i]]);var ie=ae}}]);
//# sourceMappingURL=532.7a19e245.js.map